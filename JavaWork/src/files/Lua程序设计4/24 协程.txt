24 协程
线程与协程的主要区别在于，一个程序可以并行运行多个线程，而协程却需要彼此协作运行，同时只能有一个协程运行。
只有当正在运行的协程显示地要求被挂起时其执行才会暂停。

24.1 协程基础
Lua语言中协程相关的函数都被放在表coroutine中。
函数create用于创建新协程，该函数只有一个参数，即协程要执行的代码的函数。
函数create返回一个“thread”类型的值，即新协程。
一个协程有四个状态：挂起，运行，正常和死亡。
通过函数coroutine.status来检查协程的状态。
当一个协程被创建时，它处于挂起状态。
函数resume用于启动或再次启动一个协程的执行。
协程的真正强大之处在于函数yield，该函数可以让一个运行中的协程挂起自己，然后在后续恢复运行。
当协程A唤醒协程B时，协程A既不是挂起状态（因为不能唤醒A），也不是运行状态，这时协程A的状态是正常状态。
Lua语言中一个非常有用的机制是通过一对resume-yield来交换数据。
第一个resume函数（没有对应等待它的yield）会把所有的额外参数传递给协程的主函数。
在函数coroutine.resume的返回值中，第一个返回值为true时表示没有错误，之后的返回值对应函数yield的参数。
与之对应的是，函数coroutine.yield的返回值是对应的resume的参数。